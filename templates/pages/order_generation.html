<div class="page-content active">
    <div class="page-header" style="margin-bottom:1rem;padding-bottom:0.75rem;">
        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:0.75rem;">
            <div>
                <h2 style="font-size:1.5rem;">ğŸ“‹ <span data-i18n="og_page_title">Order Generation</span></h2>
                <p style="font-size:0.85rem;color:#6B7280;" data-i18n="og_subtitle">Create local and international
                    supply orders</p>
            </div>
            <div style="display:flex;gap:0.6rem;flex-wrap:wrap;">
                <button class="btn btn-success btn-sm" onclick="ogNewOrder()">â• <span data-i18n="og_btn_new_order">New
                        Order</span></button>
                <button class="btn btn-secondary btn-sm" onclick="ogLoadOrders()">ğŸ”„ <span
                        data-i18n="og_btn_refresh">Refresh</span></button>
            </div>
        </div>
    </div>

    <!-- STAT CARDS -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:0.6rem;margin-bottom:1rem;">
        <div class="stat-card" style="padding:0.75rem;gap:0.6rem;">
            <div class="stat-icon" style="font-size:1.2rem;width:36px;height:36px;min-width:36px;">ğŸ“‹</div>
            <div class="stat-info">
                <h3 id="og-stat-total" style="font-size:1.3rem;">0</h3>
                <p style="font-size:0.75rem;" data-i18n="og_stat_total">Total</p>
            </div>
        </div>
        <div class="stat-card" style="padding:0.75rem;gap:0.6rem;">
            <div class="stat-icon"
                style="font-size:1.2rem;width:36px;height:36px;min-width:36px;background:linear-gradient(135deg,#6366F1,#4F46E5);">
                ğŸª</div>
            <div class="stat-info">
                <h3 id="og-stat-local" style="font-size:1.3rem;">0</h3>
                <p style="font-size:0.75rem;" data-i18n="og_stat_local">Local</p>
            </div>
        </div>
        <div class="stat-card" style="padding:0.75rem;gap:0.6rem;">
            <div class="stat-icon"
                style="font-size:1.2rem;width:36px;height:36px;min-width:36px;background:linear-gradient(135deg,#0EA5E9,#0284C7);">
                ğŸŒ</div>
            <div class="stat-info">
                <h3 id="og-stat-intl" style="font-size:1.3rem;">0</h3>
                <p style="font-size:0.75rem;" data-i18n="og_stat_intl">Intl</p>
            </div>
        </div>
        <div class="stat-card" style="padding:0.75rem;gap:0.6rem;">
            <div class="stat-icon"
                style="font-size:1.2rem;width:36px;height:36px;min-width:36px;background:linear-gradient(135deg,#F59E0B,#D97706);">
                â³</div>
            <div class="stat-info">
                <h3 id="og-stat-pending" style="font-size:1.3rem;">0</h3>
                <p style="font-size:0.75rem;" data-i18n="og_stat_pending">Pending</p>
            </div>
        </div>
        <div class="stat-card" style="padding:0.75rem;gap:0.6rem;">
            <div class="stat-icon"
                style="font-size:1.2rem;width:36px;height:36px;min-width:36px;background:linear-gradient(135deg,#10B981,#059669);">
                âœ…</div>
            <div class="stat-info">
                <h3 id="og-stat-approved" style="font-size:1.3rem;">0</h3>
                <p style="font-size:0.75rem;" data-i18n="og_stat_approved">Approved</p>
            </div>
        </div>
    </div>

    <!-- ORDERS LIST -->
    <div class="form-card" id="og-list-section" style="padding:1rem;">
        <div style="display:flex;gap:0.6rem;flex-wrap:wrap;align-items:flex-end;margin-bottom:0.75rem;">
            <div style="flex:1;min-width:120px;">
                <label style="font-size:0.8rem;font-weight:600;display:block;margin-bottom:0.2rem;"
                    data-i18n="og_lbl_type">Type</label>
                <select id="og-filter-type" onchange="ogFilterOrders()"
                    style="width:100%;padding:0.4rem;border:2px solid var(--border-light);border-radius:6px;font-size:0.85rem;">
                    <option value="" data-i18n="og_all_types">All Types</option>
                    <option value="Local" data-i18n="og_type_local">Local</option>
                    <option value="International" data-i18n="og_type_intl">International</option>
                </select>
            </div>
            <div style="flex:1;min-width:120px;">
                <label style="font-size:0.8rem;font-weight:600;display:block;margin-bottom:0.2rem;"
                    data-i18n="og_lbl_project">Project</label>
                <select id="og-filter-project" onchange="ogFilterOrders()"
                    style="width:100%;padding:0.4rem;border:2px solid var(--border-light);border-radius:6px;font-size:0.85rem;">
                    <option value="" data-i18n="og_all_projects">All Projects</option>
                </select>
            </div>
            <div style="flex:2;min-width:160px;">
                <label style="font-size:0.8rem;font-weight:600;display:block;margin-bottom:0.2rem;"
                    data-i18n="og_lbl_search">Search</label>
                <input type="text" id="og-search" oninput="ogFilterOrders()" placeholder="Order number or descriptionâ€¦"
                    data-i18n-placeholder="og_search_ph"
                    style="width:100%;padding:0.4rem;border:2px solid var(--border-light);border-radius:6px;font-size:0.85rem;">
            </div>
            <button class="btn btn-secondary btn-sm" onclick="ogClearFilters()"
                style="padding:0.4rem 0.75rem;font-size:0.82rem;">ğŸ”„</button>
        </div>
        <div style="overflow-x:auto;">
            <table style="width:100%;border-collapse:collapse;font-size:0.85rem;min-width:600px;">
                <thead id="og-list-thead"
                    style="background:linear-gradient(135deg,var(--primary-dark-blue),var(--mid-blue));color:white;">
                    <tr>
                        <th style="padding:0.5rem 0.6rem;text-align:left;" data-i18n="og_th_order_no">Order No.</th>
                        <th style="padding:0.5rem 0.6rem;text-align:left;" data-i18n="og_th_type">Type</th>
                        <th style="padding:0.5rem 0.6rem;text-align:left;" data-i18n="og_th_family">Family</th>
                        <th style="padding:0.5rem 0.6rem;text-align:left;" data-i18n="og_th_description">Description
                        </th>
                        <th style="padding:0.5rem 0.6rem;text-align:left;" data-i18n="og_th_stock_date">Stock Date</th>
                        <th style="padding:0.5rem 0.6rem;text-align:left;" data-i18n="og_th_req_delivery">Req. Delivery
                        </th>
                        <th style="padding:0.5rem 0.6rem;text-align:center;" data-i18n="og_th_updated">Last Updated</th>
                        <th style="padding:0.5rem 0.6rem;text-align:center;" data-i18n="og_th_lines">Lines</th>
                        <th style="padding:0.5rem 0.6rem;text-align:center;width:96px;" data-i18n="og_th_actions">
                            Actions</th>
                    </tr>
                </thead>
                <tbody id="og-orders-tbody">
                    <tr>
                        <td colspan="9" style="text-align:center;padding:1.5rem;color:#9CA3AF;" data-i18n="og_loading">
                            Loadingâ€¦</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- ORDER EDITOR -->
    <div id="og-editor-section" style="display:none;">
        <div class="form-card" style="margin-bottom:0.5rem;padding:0.85rem;">
            <div
                style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.75rem;gap:0.5rem;flex-wrap:wrap;">
                <div style="display:flex;align-items:center;gap:0.6rem;">
                    <button id="og-header-toggle" onclick="ogToggleHeader()"
                        style="background:#EFF6FF;border:1px solid #BFDBFE;color:#1D4ED8;border-radius:4px;padding:0.25rem 0.5rem;cursor:pointer;font-size:0.85rem;font-weight:700;">â–¼</button>
                    <h3 id="og-editor-title" style="color:var(--primary-dark-blue);margin:0;font-size:1.1rem;"></h3>
                </div>
                <button class="btn btn-secondary btn-sm" onclick="ogCloseEditor()"
                    style="background:#374151;font-weight:600;">
                    â† <span data-i18n="og_back_to_list">Back to List</span>
                </button>
            </div>
            <div id="og-header-body">
                <div
                    style="display:flex;gap:0;margin-bottom:0.85rem;border:2px solid var(--border-light);border-radius:7px;overflow:hidden;width:fit-content;">
                    <button id="og-tab-local" onclick="ogSwitchType('Local')"
                        style="padding:0.45rem 1.25rem;border:none;cursor:pointer;font-weight:600;font-size:0.88rem;background:linear-gradient(135deg,var(--mid-blue),var(--cyan-flow));color:white;">
                        ğŸª <span data-i18n="og_type_local">Local</span>
                    </button>
                    <button id="og-tab-intl" onclick="ogSwitchType('International')"
                        style="padding:0.45rem 1.25rem;border:none;cursor:pointer;font-weight:600;font-size:0.88rem;background:white;color:#6B7280;">
                        ğŸŒ <span data-i18n="og_type_intl">International</span>
                    </button>
                </div>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(165px,1fr));gap:0.6rem;">
                    <div class="form-group">
                        <label
                            style="font-weight:600;font-size:0.8rem;margin-bottom:0.2rem;display:flex;align-items:center;gap:0.3rem;">
                            <span data-i18n="og_lbl_order_number">Order Number</span>
                            <span id="og-num-badge"
                                style="background:#EFF6FF;color:#1D4ED8;padding:0.06rem 0.3rem;border-radius:3px;font-size:0.68rem;"
                                data-i18n="og_auto">Auto</span>
                            <span style="color:#DC2626;">*</span>
                        </label>
                        <input type="text" id="og-order-number" readonly
                            style="padding:0.42rem 0.55rem;border:2px solid var(--border-light);border-radius:6px;width:100%;background:#F9FAFB;color:var(--primary-dark-blue);font-weight:700;font-size:0.9rem;letter-spacing:0.3px;">
                    </div>
                    <div class="form-group">
                        <label style="font-weight:600;font-size:0.8rem;margin-bottom:0.2rem;"><span
                                data-i18n="og_lbl_project">Project</span> <span style="color:#DC2626;">*</span></label>
                        <select id="og-header-project" onchange="ogUpdateLocalNum()"
                            style="padding:0.42rem 0.55rem;border:2px solid var(--border-light);border-radius:6px;width:100%;font-size:0.85rem;">
                            <option value="" data-i18n="og_select_project">-- Project --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label style="font-weight:600;font-size:0.8rem;margin-bottom:0.2rem;"><span
                                data-i18n="og_lbl_family">Order Family</span> <span
                                style="color:#DC2626;">*</span></label>
                        <select id="og-order-family" onchange="ogUpdateLocalNum()"
                            style="padding:0.42rem 0.55rem;border:2px solid var(--border-light);border-radius:6px;width:100%;font-size:0.85rem;background:white;">
                            <option value="Med">ğŸ¥ Med</option>
                            <option value="Log">ğŸšš Log</option>
                            <option value="Lib">ğŸ“š Lib</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label style="font-weight:600;font-size:0.8rem;margin-bottom:0.2rem;"><span
                                data-i18n="og_lbl_description">Description</span> <span
                                style="color:#DC2626;">*</span></label>
                        <input type="text" id="og-order-desc"
                            style="padding:0.42rem 0.55rem;border:2px solid var(--border-light);border-radius:6px;width:100%;font-size:0.85rem;">
                    </div>
                    <div class="form-group">
                        <label style="font-weight:600;font-size:0.8rem;margin-bottom:0.2rem;"><span
                                data-i18n="og_lbl_stock_date">Stock Date</span> <span
                                style="color:#DC2626;">*</span></label>
                        <input type="date" id="og-stock-date"
                            style="padding:0.42rem 0.55rem;border:2px solid var(--border-light);border-radius:6px;width:100%;font-size:0.85rem;">
                    </div>
                    <div class="form-group">
                        <label style="font-weight:600;font-size:0.8rem;margin-bottom:0.2rem;"><span
                                data-i18n="og_lbl_expected_reception">Expected Reception</span> <span
                                style="color:#DC2626;">*</span></label>
                        <input type="date" id="og-delivery-date"
                            style="padding:0.42rem 0.55rem;border:2px solid var(--border-light);border-radius:6px;width:100%;font-size:0.85rem;">
                    </div>
                    <div class="form-group">
                        <label style="font-weight:600;font-size:0.8rem;margin-bottom:0.2rem;">ğŸ’± <span
                                data-i18n="og_lbl_currency">Currency</span></label>
                        <select id="og-currency-select" onchange="ogSetCurrency(this.value)"
                            style="padding:0.42rem 0.55rem;border:2px solid var(--border-light);border-radius:6px;width:100%;font-size:0.85rem;background:white;"></select>
                    </div>
                </div>
            </div>
        </div>

        <!-- LINES TOOLBAR -->
        <div
            style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:0.45rem;margin-bottom:0.45rem;">
            <div style="display:flex;gap:0.4rem;align-items:center;flex-wrap:wrap;">
                <button class="btn btn-primary btn-sm" onclick="ogAddLine()"
                    style="padding:0.35rem 0.7rem;font-size:0.8rem;">â• <span data-i18n="og_btn_add_line">Add
                        Line</span></button>
                <button class="btn btn-secondary btn-sm" onclick="ogClearAllLines()"
                    style="padding:0.35rem 0.6rem;font-size:0.8rem;background:#6B7280;">ğŸ—‘ï¸ <span
                        data-i18n="og_btn_clear">Clear</span></button>
                <span style="color:#6B7280;font-size:0.8rem;"><span data-i18n="og_lines_label">Lines:</span> <strong
                        id="og-line-count">0</strong></span>
            </div>
            <div style="display:flex;gap:0.4rem;align-items:center;position:relative;">
                <div id="og-excel-pill" onclick="document.getElementById('og-excel-input').click()"
                    ondragover="event.preventDefault();this.style.background='#EFF6FF';"
                    ondragleave="this.style.background='';" ondrop="ogHandleDrop(event)"
                    style="display:flex;align-items:center;gap:0.3rem;padding:0.35rem 0.65rem;border:2px dashed var(--border-light);border-radius:6px;cursor:pointer;background:white;font-size:0.78rem;color:#6B7280;white-space:nowrap;">
                    ğŸ“Š <span data-i18n="og_btn_import_excel">Import Excel</span>
                    <input type="file" id="og-excel-input" accept=".xlsx,.xls" style="display:none;"
                        onchange="ogHandleExcelUpload(event)">
                </div>
                <div id="og-upload-status"
                    style="position:absolute;right:0;top:calc(100% + 4px);min-width:200px;z-index:50;"></div>
                <button onclick="ogOpenFullscreen()"
                    style="display:flex;align-items:center;gap:0.3rem;padding:0.35rem 0.7rem;background:linear-gradient(135deg,#1E3A5F,#374151);color:white;border:none;border-radius:6px;cursor:pointer;font-size:0.8rem;font-weight:600;white-space:nowrap;">
                    â›¶ <span data-i18n="og_btn_expand">Expand</span>
                </button>
            </div>
        </div>

        <!-- LINES TABLE -->
        <div class="form-card" style="padding:0;overflow:hidden;margin-bottom:0;">
            <div id="og-lines-wrapper"
                style="overflow-x:auto;max-height:45vh;overflow-y:auto;transition:max-height 0.3s ease;">
                <table id="og-lines-table"
                    style="width:100%;border-collapse:collapse;font-size:0.8rem;table-layout:fixed;">
                    <thead id="og-lines-thead" style="position:sticky;top:0;z-index:2;"></thead>
                    <tbody id="og-lines-tbody">
                        <tr id="og-empty-row">
                            <td colspan="20" style="text-align:center;padding:2rem;color:#9CA3AF;">
                                <div style="font-size:1.8rem;margin-bottom:0.3rem;">ğŸ“¦</div>
                                <p style="font-size:0.85rem;" data-i18n="og_no_lines">No lines yet â€” click Add Line or
                                    Import Excel.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- TOTALS BAR -->
        <div id="og-totals-bar"
            style="display:none;background:linear-gradient(135deg,var(--primary-dark-blue),var(--mid-blue));color:white;padding:0.45rem 1rem;border-radius:0 0 6px 6px;gap:1.25rem;flex-wrap:wrap;font-size:0.83rem;align-items:center;">
            <span>ğŸ“¦ <strong id="og-total-lines-label">0</strong> <span data-i18n="og_lines_word">lines</span></span>
            <span><span data-i18n="og_qty_label">Qty:</span> <strong id="og-total-qty">0</strong></span>
            <span>ğŸ’° <span data-i18n="og_total_label">Total:</span> <strong id="og-total-price">0.00</strong></span>
        </div>

        <!-- SAVE BAR -->
        <div style="display:flex;gap:0.6rem;margin-top:0.6rem;flex-wrap:wrap;align-items:center;">
            <button class="btn btn-success btn-sm" onclick="ogSaveOrder()" id="og-save-btn" style="font-size:0.9rem;">ğŸ’¾
                <span data-i18n="og_btn_save">Save Order</span></button>
            <button class="btn btn-secondary btn-sm" onclick="ogCloseEditor()"
                style="font-size:0.9rem;background:#6B7280;">âœ• <span data-i18n="og_btn_cancel">Cancel</span></button>
        </div>
    </div>

    <!-- DELETE MODAL -->
    <div id="og-delete-modal" class="popup-overlay" style="display:none;z-index:10000;">
        <div class="popup-content" style="max-width:400px;">
            <div class="popup-header">
                <h3 class="popup-title">âš ï¸ <span data-i18n="og_confirm_delete">Confirm Delete</span></h3>
                <button class="popup-close" onclick="ogCloseDeleteModal()">Ã—</button>
            </div>
            <div style="padding:1.25rem;">
                <p data-i18n="og_delete_warning">Delete this entire order and all its lines?</p>
                <p style="color:#DC2626;font-weight:700;margin-top:0.4rem;font-size:1rem;" id="og-delete-label"></p>
            </div>
            <div class="btn-group" style="padding:0 1.25rem 1.25rem;">
                <button class="btn btn-danger" onclick="ogConfirmDelete()" id="og-confirm-delete-btn">ğŸ—‘ï¸ <span
                        data-i18n="og_btn_delete">Delete</span></button>
                <button class="btn btn-secondary" onclick="ogCloseDeleteModal()"
                    data-i18n="og_btn_cancel">Cancel</button>
            </div>
        </div>
    </div>

    <!-- ogLoadSheetJSStyle is defined in order-generation.js (always available) -->

    <!-- HIDDEN TRANSLATION ANCHORS â€” read by ogT(), kept in sync by i18n system -->
    <div style="display:none;">
        <span id="og-trans-order_saved" data-i18n="og_order_saved">Order saved successfully!</span>
        <span id="og-trans-order_deleted" data-i18n="og_order_deleted">Order deleted!</span>
        <span id="og-trans-unsaved_warning" data-i18n="og_unsaved_warning">You have unsaved changes. Leave
            anyway?</span>
        <span id="og-trans-type_locked" data-i18n="og_type_locked">Order type cannot be changed when editing.</span>
        <span id="og-trans-at_least_one_line" data-i18n="og_at_least_one_line">At least one line is required</span>
        <span id="og-trans-item_code_required" data-i18n="og_item_code_required">Item code required on all lines</span>
        <span id="og-trans-qty_required" data-i18n="og_qty_required">Quantity must be > 0 on all lines</span>
        <span id="og-trans-order_num_required" data-i18n="og_order_num_required">Order number is required</span>
        <span id="og-trans-desc_required" data-i18n="og_desc_required">Order description is required</span>
        <span id="og-trans-stock_date_required" data-i18n="og_stock_date_required">Stock date is required</span>
        <span id="og-trans-delivery_required" data-i18n="og_delivery_required">Expected reception date is
            required</span>
        <span id="og-trans-project_required" data-i18n="og_project_required">Project is required</span>
        <span id="og-trans-error_loading" data-i18n="og_error_loading">Error loading order</span>
        <span id="og-trans-error_saving" data-i18n="og_error_saving">Error saving</span>
        <span id="og-trans-new_order_title" data-i18n="og_new_order_title">ğŸ“‹ New Order</span>
        <span id="og-trans-edit_order_title" data-i18n="og_edit_order_title">âœï¸ Edit</span>
        <span id="og-trans-deleting" data-i18n="og_deleting">â³ Deletingâ€¦</span>
        <span id="og-trans-saving" data-i18n="og_saving">â³ Savingâ€¦</span>
        <span id="og-trans-collapse" data-i18n="og_collapse">âŠ  Collapse</span>
        <span id="og-trans-expand_btn" data-i18n="og_btn_expand">â›¶ Expand</span>
        <span id="og-trans-no_orders" data-i18n="og_no_orders">No orders yet</span>
        <span id="og-trans-click_new_order" data-i18n="og_click_new_order">Click "New Order" to get started</span>
        <span id="og-trans-select_project_opt" data-i18n="og_select_project_opt">â€” select â€”</span>
        <span id="og-trans-select_project" data-i18n="og_select_project">-- Project --</span>
        <span id="og-trans-all_projects" data-i18n="og_all_projects">All Projects</span>
        <span id="og-trans-lines_imported" data-i18n="og_lines_imported">lines imported</span>
        <span id="og-trans-email_sent" data-i18n="og_email_sent">File downloaded. Attach manually.</span>
        <span id="og-trans-export_success" data-i18n="og_export_success">Exported</span>
        <span id="og-trans-val_waiting_quote" data-i18n="og_val_waiting_quote">Waiting Quote</span>
        <span id="og-trans-val_requested" data-i18n="og_val_requested">Requested</span>
        <span id="og-trans-val_approved" data-i18n="og_val_approved">Approved</span>
        <span id="og-trans-val_rejected" data-i18n="og_val_rejected">Rejected</span>
        <span id="og-trans-val_with_supply" data-i18n="og_val_with_supply">With Supply</span>
        <span id="og-trans-stat_local" data-i18n="og_stat_local">Local</span>
        <span id="og-trans-stat_intl" data-i18n="og_stat_intl">Intl</span>
        <span id="og-trans-tooltip_edit" data-i18n="og_tooltip_edit">Edit order</span>
        <span id="og-trans-tooltip_delete" data-i18n="og_tooltip_delete">Delete order</span>
        <span id="og-trans-tooltip_export" data-i18n="og_tooltip_export">Export to Excel</span>
        <span id="og-trans-tooltip_email" data-i18n="og_tooltip_email">Share by email</span>
        <span id="og-trans-col_item_code" data-i18n="og_col_item_code">Item Code</span>
        <span id="og-trans-col_description" data-i18n="og_col_description">Description</span>
        <span id="og-trans-col_qty" data-i18n="og_col_qty">Qty</span>
        <span id="og-trans-col_pack" data-i18n="og_col_pack">Pack.</span>
        <span id="og-trans-col_price_pk" data-i18n="og_col_price_pk">Price/Pk</span>
        <span id="og-trans-col_total" data-i18n="og_col_total">Total</span>
        <span id="og-trans-col_remarks" data-i18n="og_col_remarks">Remarks</span>
        <span id="og-trans-col_project" data-i18n="og_col_project">Project</span>
        <span id="og-trans-col_validation" data-i18n="og_col_validation">Validation Status</span>
        <span id="og-trans-loading" data-i18n="og_loading">Loadingâ€¦</span>
    </div>
</div>